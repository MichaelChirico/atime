<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Regular expression examples}
-->

# Comparisons

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

## no setup, only one algo at a time (no controlled comparison), yes
## stop after going over time limit.
## testComplexity::asymptoticTimings()

## can not store results if check=FALSE, results must be equal if
## check=TRUE, no stop after going over time limit.
if(FALSE){
  max.N <- 20
  bench::press(
    N=1:max.N,
    {
      cat(sprintf("subject/pattern size %4d / %4d\n", N, max.N))
      subject <- paste(rep("a", N), collapse="")
      pattern <- paste(rep(c("(a)?", "\\1"), each=N), collapse="")
      bench::mark(
        check=FALSE,
        ICU=stringi::stri_match(subject, regex=pattern),
        PCRE=regexpr(pattern, subject, perl=TRUE),
        TRE=regexpr(pattern, subject, perl=FALSE),
        min_iterations=0,
        min_time=0.01
      )
    })
}

max.N <- 20
atime.list <- atime::atime(
  ICU=stringi::stri_match(subject, regex=pattern),
  PCRE=regexpr(pattern, subject, perl=TRUE),
  TRE=regexpr(pattern, subject, perl=FALSE),
  times=10,
  seconds.limit=0.1,
  N=1:max.N,
  setup={
    cat(sprintf("subject/pattern size %4d / %4d\n", N, max.N))
    subject <- paste(rep("a", N), collapse="")
    pattern <- paste(rep(c("(a)?", "\\1"), each=N), collapse="")
  })

if(require(ggplot2)){
  ggplot()+
    geom_ribbon(aes(
      N, ymin=min, ymax=max, fill=expr.name),
      data=atime.list$timing,
      alpha=0.5)+
    geom_line(aes(
      N, median, color=expr.name),
      data=atime.list$timing)
}

time.dt <- atime::atime(
  ICU=stringi::stri_match(subject, regex=pattern),
  RE2=re2::re2_match(subject, pattern),
  PCRE=regexpr(pattern, subject, perl=TRUE),
  TRE=regexpr(pattern, subject, perl=FALSE),
  setup={
    subject <- paste(rep("a", N), collapse="")
    pattern <- paste(rep(c("a?", "a"), each=N), collapse="")
  },
  N=1:25,
  times=10)
```
